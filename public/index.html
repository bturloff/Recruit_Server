<!DOCTYPE html>
<html lang="en" class="no-js">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>American Express Recuriting Export Tool</title>
		<meta name="description" content="Natural Language Form with custom text input and drop-down lists" />
		<meta name="keywords" content="Natural Language UI, sentence form, text input, contenteditable, html5, css3, jquery" />
		<meta name="author" content="Codrops" />
		<link rel="shortcut icon" href="../favicon.ico">
		<link rel="stylesheet" type="text/css" href="css/default.css" />
		<link rel="stylesheet" type="text/css" href="css/component.css" />
		<script src="js/modernizr.custom.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="js/js_dl.js"></script>
	</head>
	<body class="nl-blurred">
		<div class="container demo-1">
			<!-- Top Navigation -->
			<div class="codrops-top clearfix">
			</div>
			<header>
				<h1>American Express Recruiting <span>Simple CSV Student Export Tool</span></h1>
			</header>
			<div class="main clearfix">
				<form id="nl-form" class="nl-form">
					I want students from
					<select id="schoolName">
						<option value="all" selected>all schools</option>
						<option value="arizona state">Arizona State</option>
						<option value="florida state">Florida State</option>
						<option value="austin texas">Austin Texas University</option>
						<option value="princeton university">Princeton University</option>
					</select>
					<br />from the time of
					<select id="fromMonth">
						<option value="00" selected>month</option>
						<option value="01">January</option>
						<option value="02">Feburary</option>
						<option value="03">March</option>
						<option value="04">April</option>
						<option value="05">May</option>
						<option value="06">June</option>
						<option value="07">July</option>
						<option value="08">August</option>
						<option value="09">September</option>
						<option value="10">October</option>
						<option value="11">November</option>
						<option value="12">December</option>
					</select>
					<select id="fromDay">
            <option value="00" selected>day</option>
						<option value="01">1</option>
						<option value="02">2</option>
						<option value="03">3</option>
						<option value="04">4</option>
						<option value="05">5</option>
						<option value="06">6</option>
						<option value="07">7</option>
						<option value="08">8</option>
						<option value="09">9</option>
						<option value="10">10</option>
						<option value="11">11</option>
						<option value="12">12</option>
						<option value="13">13</option>
						<option value="14">14</option>
						<option value="15">15</option>
						<option value="16">16</option>
						<option value="17">17</option>
						<option value="18">18</option>
						<option value="19">19</option>
						<option value="20">20</option>
						<option value="21">21</option>
						<option value="22">22</option>
						<option value="23">23</option>
						<option value="24">24</option>
						<option value="25">25</option>
						<option value="26">26</option>
						<option value="27">27</option>
						<option value="28">28</option>
						<option value="29">29</option>
						<option value="30">30</option>
						<option value="31">31</option>
					</select>
					<select id="fromYear">
						<option value="2016" selected>year</option>
						<option value="2018">2018</option>
						<option value="2017">2017</option>
						<option value="2016">2016</option>
					</select>
					<br />
						to the time of
						<select id="toMonth">
							<option value="00" selected>month</option>
							<option value="01">January</option>
							<option value="02">Feburary</option>
							<option value="03">March</option>
							<option value="04">April</option>
							<option value="05">May</option>
							<option value="06">June</option>
							<option value="07">July</option>
							<option value="08">August</option>
							<option value="09">September</option>
							<option value="10">October</option>
							<option value="11">November</option>
							<option value="12">December</option>
						</select>
						<select id="toDay">
							<option value="00" selected>day</option>
							<option value="01">1</option>
							<option value="02">2</option>
							<option value="03">3</option>
							<option value="04">4</option>
							<option value="05">5</option>
							<option value="06">6</option>
							<option value="07">7</option>
							<option value="08">8</option>
							<option value="09">9</option>
							<option value="10">10</option>
							<option value="11">11</option>
							<option value="12">12</option>
							<option value="13">13</option>
							<option value="14">14</option>
							<option value="15">15</option>
							<option value="16">16</option>
							<option value="17">17</option>
							<option value="18">18</option>
							<option value="19">19</option>
							<option value="20">20</option>
							<option value="21">21</option>
							<option value="22">22</option>
							<option value="23">23</option>
							<option value="24">24</option>
							<option value="25">25</option>
							<option value="26">26</option>
							<option value="27">27</option>
							<option value="28">28</option>
							<option value="29">29</option>
							<option value="30">30</option>
							<option value="31">31</option>
						</select>
						<select id="toYear">
							<option value="1" selected>year</option>
							<option value="2018">2018</option>
							<option value="2017">2017</option>
							<option value="2016">2016</option>
						</select>
					<div class="nl-submit-wrap">
						<div class="nl-submit" onclick='exportData()'>Export Student CSV Data</div>
					</div>
					<div class="nl-overlay"></div>
				</form>
			</div>
		</div><!-- /container -->
		<script src="js/nlform.js"></script>
		<script>
			var nlform = new NLForm( document.getElementById( 'nl-form' ) );

      //Parse the form input into unix time for easier processing
      Date.prototype.getUnixTime = function() { return this.getTime()/1000|0 };

      //Process the NLP form to the server side in the right format
			function exportData() {

        var schoolName = document.getElementById("schoolName");
        var fromMonth   = document.getElementById("fromMonth");
        var fromDay  = document.getElementById("fromDay");
        var fromYear  = document.getElementById("fromYear");
        var toMonth  = document.getElementById("toMonth");
        var toDay  = document.getElementById("toDay");
        var toYear  = document.getElementById("toYear");

        var schoolName = schoolName.options[schoolName.selectedIndex].text

        var fromData = fromDay.options[fromDay.selectedIndex].text + '-' + fromMonth.options[fromMonth.selectedIndex].text + '-' + fromYear.options[fromYear.selectedIndex].text;
        var fromUNIX = new Date(fromData).getUnixTime();

        var toData = toDay.options[toDay.selectedIndex].text + '-' + toMonth.options[toMonth.selectedIndex].text + '-' + toYear.options[toYear.selectedIndex].text;
        var toUNIX = new Date(toData).getUnixTime();

        encryptedString = btoa(schoolName + '$' + fromUNIX + '$' + toUNIX);
        processRequest(encryptedString)
			}

      function processRequest(encryptedString) {
        $.fileDownload("/getStudents/" + encryptedString);
      }
		</script>
	</body>
</html>
